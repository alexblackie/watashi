<!doctype html>
<html lang="en-CA">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>Simple Backup Script for Linux Servers &mdash; Alex Blackie</title>
<link rel="stylesheet" href="/_/site.css" type="text/css">
<link rel="stylesheet" href="/_/code.css" type="text/css">
<link rel="alternate" type="application/rss+xml" title="Alex Blackie's Blog" href="/feed.xml">





<script async defer data-domain="alexblackie.com" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
<div class="siteMain">
<header class="siteHeader">
<h1>
<a class="siteHeader--brandLink" href="/">
<img src="/_/avi.jpg" alt="Avatar of Alex Blackie." width="46" height="46"><br>
<span>
Alex Blackie<br>
<em>The Internet Sensation&trade;</em>
</span>
</a>
</h1>

<input id="mobileHeaderToggle" type="checkbox" role="button" title="Toggle Menu">
<label id="mobileHeaderToggleIcon" for="mobileHeaderToggle"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></label>

<div class="mobileCollapsed">
<nav class="siteMenu">
<a class="active" href="/articles"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> Articles</a>
<a class="" href="/setup/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg> My Setup</a>
<a class="" href="/about/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg> About Me</a>
</nav>
</div>
</header>

<div class="siteContent">
<div class="articleOldWarning withAside">
<aside>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
</aside>
<p class="besideAside">
<strong>This article is over two years old.</strong> Life moves
quickly, and thus there is a good chance any references,
recommendations, or opinions in this content are out of date. Make sure
to verify any information independently.
</p>
</div>
<article class="singleArticle">
<header class="singleArticle--header">
<h1>Simple Backup Script for Linux Servers</h1>
<div class="singleArticle--header--meta">Published December 25 2010 </div>
</header>



<div class="singleArticle--body">
			<p>I administer a local development server. I use it to practice my Unix terminal kung-fu, as well as develop some local intranet web applications. I&#8217;ve learned a lot from the old box. I&#8217;ve written a small bash script that I use to generate a backup of certain directories and compress it as a tarball.</p>

<h3>The Code</h3>

<p>Let&#8217;s start off with the final source code&#8230;</p>

<div class="highlight"><pre><span></span><span class="nv">THE_DATE</span><span class="o">=</span><span class="sb">`</span>date <span class="s2">&quot;+%Y-%m-%d&quot;</span><span class="sb">`</span>
<span class="nb">cd</span> /var/backups
mkdir <span class="nv">$THE_DATE</span>
<span class="nb">cd</span> <span class="nv">$THE_DATE</span>
tar cvzf latest_backup.tar.gz -C / var/www home/alex etc usr/bin
</pre></div>

<h3>Pre-run checks</h3>

<p>
	First, make sure there is a directory <code>/var/backups</code>. It
	doesn&#8217;t matter if it already exists, just as long as
	it&#8217;s there. Also, make sure you can run this program as
	root.
</p>

<h3>Setting it up</h3>

<p>
	Make a new file in <code>/usr/bin</code>, name it whatever you want
	(I call mine <code>wwwbackup</code>). The content of that file is
	the source code above.
</p>

<p>Save the file, then on the command line, run this command:</p>

<pre>sudo chmod +x /usr/bin/yourfilename</pre>

<p>That command will make the file executable by the system.</p>

<h3>Configuring</h3>

<p>
	The only line you&#8217;re going to want to change is the last line.
	At the end there are a few directory paths, these are the
	directories to be included in the backup. Each directory is
	separated by a space. Make sure you <strong>leave the first / and
	the space after it.</strong>
</p>

<p>For example, if I wanted to only backup <code>/var/www</code> the last line would read:</p>

<pre>tar cvzf latest_backup.tar.gz -C / var/www</pre>

<h3>Running It</h3>

<p>You can run the program by typing <code>sudo wwwbackup</code> (where <code>wwwbackup</code> is the name of your file).</p>

<p>
	If all goes well, you&#8217;ll see a list of all the files in the
	directories you set backing up. The script will create a folder with the
	current day&#8217;s date and place a tarball under that folder with your
	backup contents.
</p>

<p>
	If you don&#8217;t want the script to list all of the files
	it&#8217;s backing up, remove the letter v from the last line. So it
	would start like: <code>tar czf</code>.
</p>
</div>
</article>
</div>
</div>

<footer	class="siteFooter mobileCollapsed">
<p>
&copy; 2013-2020 Alex Blackie. Some Rights Reserved.
</p>
<p>
This site is <a class="withIcon" href="https://github.com/alexblackie/watashi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg> open source</a>. Icons are from the wonderful <a href="https://feathericons.com">Feather Icons</a>.<br>
Powered by make, bash, Kubernetes, and significant quantities of coffee.
</p>
</footer>
</body>
</html>
